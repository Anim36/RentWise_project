{% extends 'dashboard_base.html' %}
{% load static %}

{% block title %}
  My Profile
{% endblock %}

{% block content %}
<div class="max-w-5xl mx-auto mt-8 px-4">

  <!-- Alert Messages -->
  {% for message in messages %}
    <div class="mb-4 p-3 rounded-lg bg-green-100 text-green-800 border border-green-200 flex items-center justify-between">
      <div class="flex items-center space-x-2">
        <svg class="w-5 h-5 text-green-600" fill="currentColor" viewBox="0 0 20 20">
          <path d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5Zm3.707 8.207-4 4a1 1 0 0 1-1.414 0l-2-2a1 1 0 0 1 1.414-1.414L9 10.586l3.293-3.293a1 1 0 0 1 1.414 1.414Z"/>
        </svg>
        <span class="text-sm font-medium">{{ message }}</span>
      </div>
      <button type="button" class="text-gray-500 hover:text-gray-700" onclick="this.parentElement.remove()">
        &times;
      </button>
    </div>
  {% endfor %}

  <!-- No Property Info -->
  {% if propertyCount == 0 and credit >= 5 %}
    <div class="p-6 bg-yellow-50 border border-yellow-200 rounded-lg text-center">
      <h2 class="text-red-600 font-semibold mb-3">You have not added any properties yet.</h2>
      <a href="{% url 'add-property' %}" class="inline-block bg-blue-600 text-white px-5 py-2 rounded hover:bg-blue-700 transition">
        Add a new property
      </a>
    </div>
  {% endif %}

  <!-- Property Table -->
  {% if propertyCount > 0 %}
    <div class="overflow-x-auto mt-6 shadow rounded-lg">
      <table class="min-w-full text-left text-gray-700">
        <thead class="bg-blue-600 text-white text-sm uppercase">
          <tr>
            <th class="px-4 py-3">Property Name</th>
            <th class="px-4 py-3">Location</th>
            <th class="px-4 py-3">Category</th>
            <th class="px-4 py-3">Price</th>
            <th class="px-4 py-3 text-center">Action</th>
          </tr>
        </thead>
        <tbody>
          {% for property in properties %}
            <tr class="odd:bg-white even:bg-gray-50 hover:bg-gray-100 transition">
              <td class="px-4 py-3 font-medium text-blue-700">
                <a href="/properties/{{ property.id }}" class="hover:underline">{{ property.title }}</a>
              </td>
              <td class="px-4 py-3">{{ property.location }}</td>
              <td class="px-4 py-3">{{ property.category }}</td>
              <td class="px-4 py-3 font-semibold">à§³ {{ property.price }}</td>
              <td class="px-4 py-3 text-center">
                <form action="/properties/property/delete/{{ property.id }}" method="GET">
                  <button type="submit" class="text-red-600 font-medium hover:underline">Delete</button>
                </form>
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  {% endif %}

</div>
{% endblock %}
