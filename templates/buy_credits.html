{% extends 'dashboard_base.html' %}
{% load static %}

{% block title %}
  Credit Packages
{% endblock %}

{% block content %}
<div class="max-w-5xl mx-auto mt-8 px-4">

  <!-- Page Title -->
  <h2 class="text-2xl font-semibold text-center text-gray-800 mb-6">
    Available Credit Packages
  </h2>

  <!-- Alert Messages -->
  {% for message in messages %}
    <div class="mb-4 p-4 rounded bg-green-100 text-green-800 border border-green-200">
      {{ message }}
    </div>
  {% endfor %}


  <!-- Modals -->
  {% for package in packages %}
  <div class="modal fade"
       id="buyModal{{ package.id }}"
       tabindex="-1"
       aria-labelledby="buyModalLabel{{ package.id }}"
       aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content rounded-lg overflow-hidden">

        <div class="modal-header bg-blue-600 text-white">
          <h5 class="modal-title" id="buyModalLabel{{ package.id }}">
            Buy Credit - {{ package.package_name }}
          </h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>

        <div class="modal-body p-6">
          <p class="mb-2"><strong>Payment Method:</strong> bKash</p>
          <p class="mb-2"><strong>Payment Number:</strong> 017XXXXXXXX</p>
          <p class="mb-2"><strong>Amount:</strong> à§³ {{ package.price }}</p>
          <p class="mb-4"><strong>Credits:</strong> {{ package.credit }}</p>

          <form action="/buy-credits/" method="post">
            {% csrf_token %}
            <div class="mb-4">
              <label for="transaction_id{{ package.id }}" class="block text-gray-700 mb-1">
                Transaction ID
              </label>
              <input type="text"
                     id="transaction_id{{ package.id }}"
                     name="transaction_id"
                     class="w-full border rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-400"
                     required
                     placeholder="Enter Transaction ID">
            </div>

            <input type="hidden" name="user_id" value="{{ user.id }}">
            <input type="hidden" name="package_id" value="{{ package.id }}">

            <button type="submit"
                    class="w-full bg-green-600 text-white py-2 rounded hover:bg-green-700 transition">
              Confirm Purchase
            </button>
          </form>
        </div>

      </div>
    </div>
  </div>
  {% endfor %}

</div>
{% endblock %}
